{% load static %}
<!DOCTYPE html>
<html>
<head>
  <title>지도 예제</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- 앱 스타일 -->
  <link rel="stylesheet" href="{% static 'main/style.css' %}" />

  <!-- (선택) 파비콘 404 방지: 1×1 투명 PNG -->
  <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=">
</head>
<body>
  <div class="app">
    <!-- 왼쪽 사이드바 -->
    <aside id="sidebar">
      <h3>Auto Solar 패널</h3>

      <!-- 1) 검색 -->
      <button class="nav-btn" data-target="panel-search">🔎 검색</button>
      <div id="panel-search" class="panel">
        <div class="search-row">
          <input id="addr-input" type="text" placeholder="예: 서울특별시 중구 세종대로 110" />
          <button id="btn-search">검색</button>
        </div>
        <div class="placeholder" style="margin-top:8px;">
          주소를 입력 후 Enter 또는 검색 버튼을 누르세요.
        </div>
      </div>

      <!-- 2) 필터 (체크박스 포함) -->
      <button class="nav-btn" data-target="panel-filter">🧰 필터</button>
      <div id="panel-filter" class="panel">
        <!-- 표시 레이어 -->
        <div style="margin:6px 0 10px; font-weight:600;">표시 레이어</div>
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-road" />
          도로이격
        </label>
        <!-- ✅ 추가: 주거이격 (MVT, 도로이격과 동일 방식) -->
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-resi" />
          주거이격
        </label>
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-yongdo" />
          용도구역
        </label>
        <!-- ✅ 기타(= jimok 폴리곤) -->
        <label style="display:block; margin-bottom:12px;">
          <input type="checkbox" id="chk-jimok" />
          기타
        </label>
        <!-- 기존 "표시 레이어" 섹션 안, 주거이격/용도구역/기타 아래에 이어서 추가 -->
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-nonglim" />
          농림지역
        </label>
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-nongupjin" />
          농업진흥구역
        </label>
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-jayeon" />
          자연녹지지역
        </label>
        <label style="display:block; margin-bottom:6px;">
          <input type="checkbox" id="chk-gaebal" />
          개발진흥구역
        </label>
        <label style="display:block; margin-bottom:12px;">
          <input type="checkbox" id="chk-nongupgiban" />
          농업생산기반정비사업지역
        </label>

        <!-- 지목 필터 -->
        <div style="margin:6px 0 6px; font-weight:600;">지목</div>
        <div class="filter-group" id="grp-jimok" style="line-height:1.8;">
          <label><input type="checkbox" class="jm" value="전"> 전</label><br/>
          <label><input type="checkbox" class="jm" value="답"> 답</label><br/>
          <label><input type="checkbox" class="jm" value="과수원"> 과수원</label><br/>
          <label><input type="checkbox" class="jm" value="잡종지"> 잡종지</label><br/>
          <label><input type="checkbox" class="jm" value="목장용지"> 목장용지</label><br/>
          <label><input type="checkbox" class="jm" value="염전"> 염전</label><br/>
          <label><input type="checkbox" class="jm" value="양어장"> 양어장</label>
        </div>

        <!-- 소유자 필터 -->
        <div style="margin:10px 0 6px; font-weight:600;">소유자</div>
        <div class="filter-group" id="grp-owner" style="line-height:1.8;">
          <label><input type="checkbox" class="own" value="군유지"> 군유지</label><br/>
          <label><input type="checkbox" class="own" value="국유지"> 국유지</label><br/>
          <label><input type="checkbox" class="own" value="법인"> 법인</label><br/>
          <label><input type="checkbox" class="own" value="개인"> 개인</label>
        </div>

        <div class="placeholder" style="margin-top:10px; color:#777;">
          체크하면 현재 화면 범위(BBOX)만 우선 로드합니다.
        </div>
      </div>

      <!-- 3) 프로젝트 생성 -->
      <button class="nav-btn" data-target="panel-project-create">🆕 프로젝트 생성</button>
      <div id="panel-project-create" class="panel">
        <div class="placeholder">현재 화면 상태로 프로젝트를 생성하는 기능 자리입니다.</div>
      </div>

      <!-- 4) 프로젝트 관리 -->
      <button class="nav-btn" data-target="panel-project-manage">📁 프로젝트 관리</button>
      <div id="panel-project-manage" class="panel">
        <div class="placeholder">기존 프로젝트 불러오기/목록 UI 자리입니다.</div>
      </div>

      <!-- 5) 로그인 -->
      <button class="nav-btn" data-target="panel-login">🔐 로그인</button>
      <div id="panel-login" class="panel">
        <div class="placeholder">유저별 저장/로드를 위한 로그인 UI 자리입니다.</div>
      </div>
    </aside>

    <!-- 오른쪽 지도 -->
    <main id="map"></main>
  </div>

  <!-- 🔑 VWorld 키 주입 -->
  <script>window.VWORLD_KEY = "{{ VWORLD_KEY|default:'' }}";</script>

  <!-- Leaflet -->
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- ✅ VectorGrid 추가 -->
  <script defer src="https://unpkg.com/leaflet.vectorgrid/dist/Leaflet.VectorGrid.bundled.js"></script>

  <!-- 앱 스크립트 -->
  <script defer src="{% static 'main/script.js' %}?v=20250921_02"></script>

</body>
</html>
